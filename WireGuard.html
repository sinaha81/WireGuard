<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>پنل ساخت کانفیگ WireGuard و DNS</title>
  <style>
    :root {
      --primary-color: #2196f3;
      --secondary-color: #4caf50;
      --tertiary-color: #ff9800;
      --bg-color: #121212;
      --accent-color: #FFA000;
      --text-color: #e0e0e0;
      --container-bg: #1e1e1e;
      --border-radius: 10px;
    }
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 0;
      background-color: var(--bg-color);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: var(--text-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }
    .tabs {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 25px;
    }
    .tab {
      padding: 12px 25px;
      border-radius: var(--border-radius);
      background-color: rgba(255, 160, 0, 0.7);
      cursor: pointer;
      font-weight: bold;
      transition: background 0.3s ease, transform 0.3s ease;
      user-select: none;
    }
    .tab:hover {
      background-color: rgba(255, 160, 0, 1);
      transform: scale(1.05);
    }
    .tab.active {
      background-color: var(--accent-color);
    }
    .container {
      background-color: var(--container-bg);
      width: 100%;
      max-width: 800px;
      padding: 30px;
      border-radius: var(--border-radius);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.6);
      margin-bottom: 30px;
      transition: transform 0.3s ease;
    }
    .container:hover {
      transform: scale(1.01);
    }
    h1 {
      margin-top: 0;
      margin-bottom: 20px;
      font-size: 28px;
      text-align: center;
      color: var(--primary-color);
    }
    label {
      display: block;
      margin: 12px 0 4px;
      font-size: 16px;
    }
    input, select, textarea {
      width: 100%;
      max-width: 400px;
      padding: 10px 15px;
      margin-bottom: 15px;
      border: none;
      border-radius: var(--border-radius);
      background-color: #2a2a2a;
      color: var(--text-color);
      font-size: 16px;
      transition: box-shadow 0.3s ease;
    }
    input:focus, select:focus, textarea:focus {
      outline: none;
      box-shadow: 0 0 8px var(--primary-color);
    }
    textarea {
      resize: vertical;
      height: 150px;
    }
    button {
      padding: 12px 20px;
      font-size: 16px;
      border: none;
      border-radius: var(--border-radius);
      cursor: pointer;
      transition: background 0.3s ease, transform 0.3s ease;
      margin: 5px;
      min-width: 150px;
    }
    button:hover {
      transform: scale(1.05);
    }
    #generateButton {
      background-color: var(--primary-color);
      color: #fff;
    }
    #saveButton {
      background-color: var(--tertiary-color);
      color: #fff;
    }
    #generateDNSButton {
      background-color: var(--secondary-color);
      color: #fff;
    }
    #copyDNSButton {
      background-color: var(--primary-color);
      color: #fff;
    }
    .channels {
      text-align: center;
      font-size: 16px;
    }
    .channels a {
      color: var(--primary-color);
      text-decoration: none;
      transition: text-decoration 0.3s ease;
    }
    .channels a:hover {
      text-decoration: underline;
    }
    /* فوتر ثابت در پایین صفحه */
    .footer {
      position: fixed;
      bottom: 15px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 14px;
      color: #888;
    }
  </style>
</head>
<body>

  <div class="tabs">
    <div class="tab active" id="wireguardTab">پنل WireGuard</div>
    <div class="tab" id="dnsTab">پنل DNS</div>
  </div>

  <!-- پنل WireGuard -->
  <div class="container" id="wireguardPanel">
    <h1>تولید کننده پیکربندی WireGuard</h1>
    <textarea id="configText" readonly placeholder="پیکربندی WireGuard اینجا نمایش داده می‌شود"></textarea>
    <label for="country">انتخاب کشور:</label>
    <select id="country">
      <option value="emirates">🇦🇪 Emirates</option>
      <option value="turkey">🇹🇷 Turkey</option>
      <option value="qatar">🇶🇦 Qatar</option>
      <option value="germany">🇩🇪 Germany</option>
      <option value="france">🇫🇷 France</option>
      <option value="usa">🇺🇸 USA</option>
      <option value="canada">🇨🇦 Canada</option>
      <option value="uk">🇬🇧 UK</option>
      <option value="iran">🇮🇷 Iran</option>
      <option value="saudi_arabia">🇸🇦 Saudi Arabia</option>
      <option value="japan">🇯🇵 Japan</option>
      <option value="china">🇨🇳 China</option>
      <option value="pakistan">🇵🇰 Pakistan</option>
      <option value="russia">🇷🇺 Russia</option>
    </select>

    <label for="ip_version">انتخاب نسخه آی‌پی:</label>
    <select id="ip_version">
      <option value="ipv4">IPv4</option>
      <option value="ipv6">IPv6</option>
      <option value="both" selected>IPv4 و IPv6</option>
    </select>

    <label for="configName">نام فایل پیکربندی:</label>
    <input id="configName" type="text" placeholder="نام فایل را بدون پسوند وارد کنید">

    <label for="sim_card">انتخاب سیم کارت:</label>
    <select id="sim_card">
      <option value="hmrah_eol" selected>همراه اول</option>
      <option value="Irancell">ایرانسل</option>
    </select>

    <div style="margin-top:20px;">
      <button id="generateButton">تولید پیکربندی</button>
      <button id="saveButton">ذخیره به فایل</button>
    </div>
  </div>

  <!-- پنل DNS -->
  <div class="container" id="dnsPanel" style="display:none;">
    <h1>پنل DNS کشورها</h1>
    <label for="dnsCountry">انتخاب کشور:</label>
    <select id="dnsCountry">
      <option value="emirates">🇦🇪 Emirates</option>
      <option value="turkey">🇹🇷 Turkey</option>
      <option value="qatar">🇶🇦 Qatar</option>
      <option value="germany">🇩🇪 Germany</option>
      <option value="france">🇫🇷 France</option>
      <option value="usa">🇺🇸 USA</option>
      <option value="canada">🇨🇦 Canada</option>
      <option value="uk">🇬🇧 UK</option>
      <option value="iran">🇮🇷 Iran</option>
      <option value="saudi_arabia">🇸🇦 Saudi Arabia</option>
      <option value="japan">🇯🇵 Japan</option>
      <option value="china">🇨🇳 China</option>
      <option value="pakistan">🇵🇰 Pakistan</option>
      <option value="russia">🇷🇺 Russia</option>
    </select>

    <label for="dnsIpVersion">انتخاب نسخه آی‌پی:</label>
    <select id="dnsIpVersion">
      <option value="ipv4">IPv4</option>
      <option value="ipv6">IPv6</option>
      <option value="both" selected>IPv4 و IPv6</option>
    </select>

    <div style="margin:20px 0;">
      <button id="generateDNSButton">نمایش DNS کشور انتخابی</button>
    </div>

    <textarea id="dnsText" readonly placeholder="DNS مربوط به کشور انتخابی در اینجا نمایش داده می‌شود"></textarea>
    <div style="margin-top:10px;">
      <button id="copyDNSButton">کپی DNS</button>
      <span id="copyMessage" style="margin-right:10px;"></span>
    </div>
  </div>

  <!-- کانال‌های ارتباطی -->
  <div class="channels">
    <p><strong>کانال‌های ما</strong></p>
    <p>تلگرام: <a href="https://t.me/asrnovin_ir" target="_blank">ASRNOVIN_IR</a></p>
    <p>یوتیوب: <a href="https://www.youtube.com/@aminiyt1" target="_blank">@AminiYt1</a></p>
    <p>اینستاگرام: <a href="https://instagram.com/aminiyt1" target="_blank">Aminiyt1</a></p>
  </div>

  <div class="footer">© 2025 تمامی حقوق محفوظ است.</div>

  <script>
    // مدیریت تب‌ها
    const wireguardTab = document.getElementById("wireguardTab");
    const dnsTab = document.getElementById("dnsTab");
    const wireguardPanel = document.getElementById("wireguardPanel");
    const dnsPanel = document.getElementById("dnsPanel");

    wireguardTab.addEventListener("click", () => {
      wireguardPanel.style.display = "block";
      dnsPanel.style.display = "none";
      wireguardTab.classList.add("active");
      dnsTab.classList.remove("active");
    });
    dnsTab.addEventListener("click", () => {
      wireguardPanel.style.display = "none";
      dnsPanel.style.display = "block";
      dnsTab.classList.add("active");
      wireguardTab.classList.remove("active");
    });

    // توابع تولید کلیدهای WireGuard با استفاده از Crypto API
    function generateWireguardKeys() {
      function getRandomKey() {
        const array = new Uint8Array(32);
        window.crypto.getRandomValues(array);
        let binary = "";
        array.forEach(byte => binary += String.fromCharCode(byte));
        return btoa(binary).slice(0,44);
      }
      return {
        privateKey: getRandomKey(),
        publicKey: getRandomKey(),
        preSharedKey: getRandomKey()
      };
    }

    // تولید عدد تصادفی
    function randomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    // نقشه پیشوندهای IPv4 و IPv6 برای کشورها
    const ipv4Prefixes = {
      "emirates": "217.199.",
      "turkey": "78.189.",
      "qatar": "37.205.",
      "germany": "185.21.",
      "france": "51.75.",
      "usa": "104.27.",
      "canada": "192.99.",
      "uk": "185.128.",
      "iran": "5.160.",
      "saudi_arabia": "94.74.",
      "japan": "133.242.",
      "china": "116.31.",
      "pakistan": "103.255.",
      "russia": "95.213."
    };

    const ipv6Prefixes = {
      "emirates": "2a01:4f8:1c1c::",
      "turkey": "2a01:4f8:1c1c::",
      "qatar": "2a01:4f8:1c1c::",
      "germany": "2a01:4f8:1c1c::",
      "france": "2a01:4f8:1c1c::",
      "usa": "2600:3c01::",
      "canada": "2600:3c01::",
      "uk": "2a00:1098::",
      "iran": "2a01:4f8:1c1c::",
      "saudi_arabia": "2a01:4f8:1c1c::",
      "japan": "2400:8500::",
      "china": "2400:8500::",
      "pakistan": "2400:8500::",
      "russia": "2a01:4f8:1c1c::"
    };

    // تولید آدرس‌های IPv4 و IPv6
    function generateRandomIPv4(prefix) {
      return prefix + randomInt(0, 255) + "." + randomInt(0, 255);
    }
    function generateRandomIPv6(prefix) {
      function randHex() {
        return randomInt(0, 65535).toString(16);
      }
      return prefix + randHex() + ":" + randHex() + ":" + randHex();
    }

    // تولید DNS بر اساس سیم کارت
    function generateDNSServers(sim_card) {
      if (sim_card === "hmrah_eol") return "10.202.10.10";
      else if (sim_card === "Irancell") return "78.157.42.100";
      else return "";
    }

    // تولید پیکربندی WireGuard
    function generateWireguardConfig(country, ip_version, sim_card) {
      const keys = generateWireguardKeys();
      const ipv4_prefix = ipv4Prefixes[country];
      const ipv6_prefix = ipv6Prefixes[country];

      if (ip_version !== "ipv6" && !ipv4_prefix) {
        alert("کشور انتخابی برای IPv4 نامعتبر است.");
        return "";
      }
      if (ip_version !== "ipv4" && !ipv6_prefix) {
        alert("کشور انتخابی برای IPv6 نامعتبر است.");
        return "";
      }

      let ipv4_address = (ip_version !== "ipv6") ? generateRandomIPv4(ipv4_prefix) : "";
      let ipv6_address = (ip_version !== "ipv4") ? generateRandomIPv6(ipv6_prefix) : "";
      const endpoint = generateRandomIPv4(ipv4_prefix) + ":51820";
      const dns_servers = generateDNSServers(sim_card);

      let address = "";
      if (ip_version === "ipv4") {
        address = ipv4_address + "/24";
      } else if (ip_version === "ipv6") {
        address = ipv6_address + "/64";
      } else if (ip_version === "both") {
        address = ipv4_address + "/24, " + ipv6_address + "/64";
      }

      return `[Interface]
PrivateKey = ${keys.privateKey}
Address = ${address}
DNS = ${dns_servers}
MTU = 1280
ListenPort = 51820

[Peer]
PublicKey = ${keys.publicKey}
PresharedKey = ${keys.preSharedKey}
Endpoint = ${endpoint}`;
    }

    // رویداد تولید پیکربندی WireGuard
    document.getElementById("generateButton").addEventListener("click", () => {
      const country = document.getElementById("country").value;
      const ip_version = document.getElementById("ip_version").value;
      const sim_card = document.getElementById("sim_card").value;
      let configName = document.getElementById("configName").value.trim();
      if (!configName) configName = "wireguard-config";
      const config = generateWireguardConfig(country, ip_version, sim_card);
      if (!config) return;
      document.getElementById("configText").value = config;

      // ذخیره فایل به صورت خودکار در هنگام تولید (در صورت تمایل)
      const blob = new Blob([config], { type: "text/plain" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = `${configName}.conf`;
      link.click();
    });

    // تولید DNS تصادفی بر اساس کشور و نسخه آی‌پی
    function generateRandomDNS(country, ip_version) {
      const ipv4Prefix = ipv4Prefixes;
      const ipv6Prefix = ipv6Prefixes;

      let dns = "";
      if (ip_version === "ipv4") {
        dns = generateRandomIPv4(ipv4Prefix[country]);
      } else if (ip_version === "ipv6") {
        dns = generateRandomIPv6(ipv6Prefix[country]);
      } else if (ip_version === "both") {
        dns = `${generateRandomIPv4(ipv4Prefix[country])}
78.157.42.100
${generateRandomIPv6(ipv6Prefix[country])}
${generateRandomIPv6(ipv6Prefix[country])}`;
      }
      return dns;
    }

    // رویداد تولید DNS
    document.getElementById("generateDNSButton").addEventListener("click", () => {
      const country = document.getElementById("dnsCountry").value;
      const ip_version = document.getElementById("dnsIpVersion").value;
      const dns = generateRandomDNS(country, ip_version);
      if (!dns.trim()) {
        alert("اطلاعات DNS برای کشور انتخابی موجود نیست!");
        return;
      }
      document.getElementById("dnsText").value = dns;
    });

    // رویداد کپی DNS به کلیپ‌بورد
    document.getElementById("copyDNSButton").addEventListener("click", () => {
      const dns = document.getElementById("dnsText").value;
      if (!dns.trim()) {
        alert("متنی برای کپی کردن وجود ندارد!");
        return;
      }
      navigator.clipboard.writeText(dns).then(() => {
        const copyMsg = document.getElementById("copyMessage");
        copyMsg.textContent = "DNS کپی شد!";
        setTimeout(() => { copyMsg.textContent = ""; }, 2000);
      }).catch(err => {
        alert("خطا در کپی کردن DNS: " + err);
      });
    });
  </script>

</body>
</html>
